# 抓包

### tcpdump

- tcpdump host 10.10.10.10 : 使用这个场景，就是我们需要抓到某个ip发过来的流量请求
- tcpdump prot 22 :我们想抓到当前这个端口的流量
- tcpdump -i host 127.0.0.1 and port 80 

还有很多参数:
1. -w 文件，将内容写到文件中
2. -c 数量，抓取一定数量的内容
3. -s 长度，每个报文的一定长度
4. -n 不做地址转换，比如ip地址转换为主机名，prot 80 转换为http
5. -v/-vv/-vvv 答应更加详细的报文信息
6. -e 打印二层信息，特别是mac信息


### 抓包的目的
在我看来抓包的目的是为了打通应用层和实际网络传输的鸿沟，结合实际网络环境去设计适合自身业务
的系统架构，比如将下面几点能够结合起来分析

1. 应用层日志： 包括成功、失败日志
2. 应用层性能：Rps 、tps、qps， transaction time 等
3. 应用层载荷：http 的请求和响应
4. 传输层： tcp 序列号、确认号、mss、win、 cgwin 、时延、重复确认、选择性确认、重传
丢包等
5. 网络层的 ttl， mtu ，hops ，路由表等

从这里你可以看出其实网络分层是一个非常不错的决定，但是分层也注定需要研发工程师的硬性能力
提升到： 网络层、传输层、应用层，甚至延伸到物理层。
