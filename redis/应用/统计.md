# 统计
基于redis的统计的场景还是比较多的，举个例子：签到记录、打卡系统、uv、数据埋点等。


#### 基于集合交集、并集的聚合统计
聚合统计就是把统计多个集合元素的聚合结果，一般从数学角度来说是有：交集、并集、差集几个概念
分别对应下面的几个内容。
- sunionstore ： 获取多个集合的并集
- sdiffstore： 获取多个集合的差集
- sinterstore ： 获取多个集合的交集

但是基于集合的聚合的运算是On 的操作，所以可以在专门的slave上面进行计算，建议不要在master上进行聚合计算。

#### 排序统计
排序统计的需求我们先搞清楚：我们要求能对集合的元素进行排序
- list ：fifo 按照时间顺序排列 ，具体使用lrange 来使用，但是这种情况更建议使用mysql
- zset： 按照权重大小进行排序，具体使用zrangebyscore ，这种情况就可以维持一个排行榜

#### 二值状态统计
bitmap 就是基于bit进行操作的数据类型，本身底层是string ，因为string 是保存为二进制字节数组，所以redis
就把字节数组的每个bit位利用起来，用来表示一个元素的二值状态。假设一个签到功能，使用bit位来进行存储那么一天
的内容也就一个bit ，8天才一个字节，365天就是365bit。

- setbit key
- getbit key
- bitcount key : 统计所有1值
- bitop key key1 : 做 位与 异或操作


#### 基数统计
统计不重复的值 ，虽然可以使用set、hash等。但是set、hash等相关数据结构十分耗费内存的。如果需要统计一个人今天
是否上线，那么该怎么办呢。hyperloglog 

- PFADD page1:uv user1 user2 user3 user4 user5
- PFCOUNT page1:uv

但是hyperloglog 是存在偏差的，大概是0.81%左右的偏差
